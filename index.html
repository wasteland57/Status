<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Status Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .sync-status {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            padding: 8px 16px;
            display: inline-block;
            margin-top: 10px;
            font-size: 0.9em;
        }

        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            padding: 30px;
        }

        .member-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border-left: 5px solid #e0e0e0;
        }

        .member-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }

        .member-card.need-help {
            border-left-color: #e74c3c;
            background: linear-gradient(135deg, #fff 0%, #ffebee 100%);
        }

        .member-card.good {
            border-left-color: #27ae60;
            background: linear-gradient(135deg, #fff 0%, #e8f5e8 100%);
        }

        .member-card.need-work {
            border-left-color: #f39c12;
            background: linear-gradient(135deg, #fff 0%, #fff3e0 100%);
        }

        .member-card.can-do-more {
            border-left-color: #3498db;
            background: linear-gradient(135deg, #fff 0%, #e3f2fd 100%);
        }

        .member-name {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 15px;
            color: #2c3e50;
        }

        .status-selector {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .status-selector:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.2);
        }

        .status-selector.need-help {
            border-color: #e74c3c;
            color: #e74c3c;
            font-weight: 600;
        }

        .status-selector.good {
            border-color: #27ae60;
            color: #27ae60;
            font-weight: 600;
        }

        .status-selector.need-work {
            border-color: #f39c12;
            color: #f39c12;
            font-weight: 600;
        }

        .status-selector.can-do-more {
            border-color: #3498db;
            color: #3498db;
            font-weight: 600;
        }

        .last-updated {
            font-size: 0.8em;
            color: #7f8c8d;
            margin-top: 10px;
            font-style: italic;
        }

        .legend {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            padding: 20px;
            background: #f8f9fa;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 20px;
            background: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
        }

        .legend-color.need-help { background-color: #e74c3c; }
        .legend-color.good { background-color: #27ae60; }
        .legend-color.need-work { background-color: #f39c12; }
        .legend-color.can-do-more { background-color: #3498db; }

        .connection-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 8px 16px;
            border-radius: 20px;
            color: white;
            font-size: 0.9em;
            z-index: 1000;
        }

        .connection-indicator.connected {
            background: #27ae60;
        }

        .connection-indicator.disconnected {
            background: #e74c3c;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.6; }
            100% { opacity: 1; }
        }

        .updating {
            animation: pulse 1s infinite;
        }

        @media (max-width: 768px) {
            .team-grid {
                grid-template-columns: 1fr;
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .legend {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="connection-indicator" id="connectionIndicator">● Simulated Mode</div>
    
    <div class="container">
        <div class="header">
            <h1>Team Status Tracker</h1>
            <div class="sync-status">
                <span id="syncStatus">Ready to sync with Google Sheets</span>
            </div>
        </div>

        <div class="legend">
            <div class="legend-item">
                <div class="legend-color need-help"></div>
                <span>I need help</span>
            </div>
            <div class="legend-item">
                <div class="legend-color good"></div>
                <span>I'm good</span>
            </div>
            <div class="legend-item">
                <div class="legend-color need-work"></div>
                <span>I need work</span>
            </div>
            <div class="legend-item">
                <div class="legend-color can-do-more"></div>
                <span>I can do more</span>
            </div>
        </div>

        <div class="team-grid" id="teamGrid">
            <!-- Team members will be populated here -->
        </div>
    </div>

    <script>
        // Team members data
        const teamMembers = [
            'Brendan Varga', 'Doug Kennedy', 'Gerrit Cramer', 'Isaac Miller',
            'John Stebelton', 'Joe Beattie', 'Kayla Plancon', 'Kyle Buchner',
            'Kyle Miller', 'Melanie Sobas', 'Paul Bater', 'Renee Kehren',
            'Rob Mooney', 'Scott Sieg', 'Steve Will Houser'
        ];

        // Status options
        const statusOptions = [
            { value: 'good', label: "I'm good", class: 'good' },
            { value: 'need-help', label: 'I need help', class: 'need-help' },
            { value: 'need-work', label: 'I need work', class: 'need-work' },
            { value: 'can-do-more', label: 'I can do more', class: 'can-do-more' }
        ];

        // In-memory data store (simulating server)
        let teamData = {};

        // Initialize team data
        function initializeTeamData() {
            teamMembers.forEach(name => {
                teamData[name] = {
                    status: 'good',
                    lastUpdated: new Date().toLocaleString()
                };
            });
        }

        // Create member card HTML
        function createMemberCard(name) {
            const member = teamData[name];
            const statusClass = member.status;
            
            return `
                <div class="member-card ${statusClass}" data-name="${name}">
                    <div class="member-name">${name}</div>
                    <select class="status-selector ${statusClass}" data-name="${name}">
                        ${statusOptions.map(option => `
                            <option value="${option.value}" ${member.status === option.value ? 'selected' : ''}>
                                ${option.label}
                            </option>
                        `).join('')}
                    </select>
                    <div class="last-updated">Last updated: ${member.lastUpdated}</div>
                </div>
            `;
        }

        // Render all team members
        function renderTeamMembers() {
            const teamGrid = document.getElementById('teamGrid');
            teamGrid.innerHTML = teamMembers.map(name => createMemberCard(name)).join('');
            
            // Add event listeners to dropdowns
            const selectors = document.querySelectorAll('.status-selector');
            selectors.forEach(selector => {
                selector.addEventListener('change', handleStatusChange);
            });
        }

        // Handle status change
        function handleStatusChange(event) {
            const name = event.target.dataset.name;
            const newStatus = event.target.value;
            
            // Update local data
            teamData[name] = {
                status: newStatus,
                lastUpdated: new Date().toLocaleString()
            };
            
            // Show updating indicator
            const card = document.querySelector(`[data-name="${name}"]`);
            card.classList.add('updating');
            
            // Sync to Google Sheets
            syncToGoogleSheets(name, newStatus).then(() => {
                card.classList.remove('updating');
                // Re-render to update colors and timestamp
                renderTeamMembers();
                updateSyncStatus(USE_GOOGLE_SHEETS ? 'Synced to Google Sheets!' : 'Updated locally (demo mode)');
                updateConnectionStatus(true);
            }).catch((error) => {
                card.classList.remove('updating');
                updateSyncStatus(USE_GOOGLE_SHEETS ? 'Sync failed!' : 'Updated locally (demo mode)');
                updateConnectionStatus(false);
            });
        }

        // Simulate Google Sheets sync (demo mode)
        function syncToGoogleSheets(name, status) {
            return new Promise((resolve, reject) => {
                // Simulate API call delay
                setTimeout(() => {
                    console.log(`Syncing ${name}: ${status} to Google Sheets`);
                    // In real implementation, this would make an API call
                    resolve();
                }, 1000);
            });
        }

        // Update sync status message
        function updateSyncStatus(message) {
            const syncStatus = document.getElementById('syncStatus');
            syncStatus.textContent = message;
            
            setTimeout(() => {
                syncStatus.textContent = 'Ready to sync with Google Sheets';
            }, 3000);
        }

        // Periodic data refresh from Google Sheets
        function startDataRefresh() {
            if (USE_GOOGLE_SHEETS) {
                // Fetch data every 10 seconds when using Google Sheets
                setInterval(() => {
                    fetchCurrentData();
                }, 10000);
                
                // Initial fetch
                fetchCurrentData();
            } else {
                // Simulate remote updates in demo mode
                simulateRemoteUpdates();
            }
        }

        // Simulate periodic updates from other users (demo mode only)
        function simulateRemoteUpdates() {
            setInterval(() => {
                // Randomly update a team member's status (simulating other users)
                if (Math.random() < 0.1) { // 10% chance every 5 seconds
                    const randomMember = teamMembers[Math.floor(Math.random() * teamMembers.length)];
                    const randomStatus = statusOptions[Math.floor(Math.random() * statusOptions.length)];
                    
                    teamData[randomMember] = {
                        status: randomStatus.value,
                        lastUpdated: new Date().toLocaleString()
                    };
                    
                    renderTeamMembers();
                    updateSyncStatus(`${randomMember} updated their status (simulated)`);
                }
            }, 5000);
        }

        // Initialize the application
        function init() {
            initializeTeamData();
            renderTeamMembers();
            updateConnectionStatus(USE_GOOGLE_SHEETS);
            startDataRefresh();
        }

        // Start the application
        init();

        // Google Apps Script integration
        // REPLACE THIS URL with your actual Google Apps Script web app URL
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx27HRLuPKkmUe9L-CiijrJ7tCuDTNMnZ1tk08hXgpowqdQ00_9w5iDLpnqgq0Lvr5f/exec';
        
        // Set to true when you have the Google Apps Script URL
        const USE_GOOGLE_SHEETS = true; // Change to true when ready
        
        // Real sync function for Google Sheets
        async function syncToGoogleSheets(name, status) {
            if (!USE_GOOGLE_SHEETS) {
                // Simulate sync for demo
                return new Promise(resolve => setTimeout(resolve, 1000));
            }
            
            try {
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'updateStatus',
                        name: name,
                        status: status,
                        timestamp: new Date().toISOString()
                    })
                });
                
                if (!response.ok) {
                    throw new Error('Sync failed');
                }
                
                const result = await response.json();
                if (!result.success) {
                    throw new Error(result.error || 'Sync failed');
                }
                
                return result;
            } catch (error) {
                console.error('Error syncing to Google Sheets:', error);
                throw error;
            }
        }
        
        // Fetch current data from Google Sheets
        async function fetchCurrentData() {
            if (!USE_GOOGLE_SHEETS) {
                return; // Skip in demo mode
            }
            
            try {
                const response = await fetch(GOOGLE_SCRIPT_URL + '?action=getData');
                
                if (!response.ok) {
                    throw new Error('Failed to fetch data');
                }
                
                const result = await response.json();
                if (result.success && result.data) {
                    teamData = result.data;
                    renderTeamMembers();
                    updateConnectionStatus(true);
                } else {
                    throw new Error(result.error || 'Failed to fetch data');
                }
            } catch (error) {
                console.error('Error fetching data:', error);
                updateConnectionStatus(false);
            }
        }
        
        // Update connection status indicator
        function updateConnectionStatus(connected) {
            const indicator = document.getElementById('connectionIndicator');
            if (USE_GOOGLE_SHEETS) {
                if (connected) {
                    indicator.textContent = '● Connected to Google Sheets';
                    indicator.className = 'connection-indicator connected';
                } else {
                    indicator.textContent = '● Connection Error';
                    indicator.className = 'connection-indicator disconnected';
                }
            } else {
                indicator.textContent = '● Demo Mode';
                indicator.className = 'connection-indicator disconnected';
            }
        }
    </script>
</body>
</html>