<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Status Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #f4f4f4;
    }

    h2 {
      margin-bottom: 20px;
    }

    .status-row {
      padding: 8px;
      border-radius: 6px;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
    }

    .status-row select {
      margin-left: 10px;
      padding: 6px;
      border-radius: 4px;
      font-size: 14px;
    }

    .red {
      background-color: #f8d7da;
      color: #721c24;
    }

    .green {
      background-color: #d4edda;
      color: #155724;
    }

    .orange {
      background-color: #fff3cd;
      color: #856404;
    }

    .blue {
      background-color: #d1ecf1;
      color: #0c5460;
    }
  </style>
</head>
<body>
  <h2>Team Status Dashboard</h2>
  <div id="statusBoard">Loading...</div>

  <script>
    const names = [
      "Brendan Varga", "Doug Kennedy", "Gerrit Cramer", "Isaac Miller", "John Stebelton",
      "Joe Beattie", "Kayla Plancon", "Kyle Buchner", "Kyle Miller", "Melanie Sobas",
      "Paul Bater", "Renee Kehren", "Rob Mooney", "Scott Sieg", "Steve Rowland", "Will Houser"
    ];

    const statuses = {
      "I need work": "orange",
      "I need help": "red",
      "I'm good": "green",
      "I can do more": "blue"
    };

    const endpoint = "https://script.google.com/macros/s/AKfycbwlTdK8rrQ9EBAI9cvymf0a20XVqL0FNl6fwvB0xfwFR2qQtCEiEXrq6wfHdkEFIuhhUg/exec";

    function getStatusBoard() {
      fetch(endpoint)
        .then(res => res.json())
        .then(data => {
          const board = document.getElementById("statusBoard");
          board.innerHTML = '';
          data.slice(1).forEach(row => {
            const [name, status] = row;
            const colorClass = statuses[status] || '';

            const rowDiv = document.createElement("div");
            rowDiv.className = `status-row ${colorClass}`;

            const label = document.createElement("strong");
            label.innerText = name + ": ";

            const select = document.createElement("select");
            for (let key in statuses) {
              const opt = document.createElement("option");
              opt.value = key;
              opt.text = key;
              if (status === key) opt.selected = true;
              select.appendChild(opt);
            }

            select.onchange = () => {
              fetch(endpoint, {
                method: "POST",
                body: JSON.stringify({ name: name, status: select.value }),
                headers: { "Content-Type": "application/json" }
              }).then(() => getStatusBoard());
            };

            rowDiv.appendChild(label);
            rowDiv.appendChild(select);
            board.appendChild(rowDiv);
          });
        });
    }

    getStatusBoard();
    setInterval(getStatusBoard, 10000); // Refresh every 10 seconds
  </script>
</body>
</html>
