<!DOCTYPE html>
<html>
<head>
  <title>Team Status Dashboard</title>
  <style>
    body { font-family: Arial, sans-serif; }
    .status-row { margin: 10px 0; }
    select { padding: 5px; }
    .red { background-color: #f8d7da; }
    .green { background-color: #d4edda; }
    .orange { background-color: #fff3cd; }
    .blue { background-color: #d1ecf1; }
  </style>
</head>
<body>
  <h2>Team Status Dashboard</h2>
  <div id="statusBoard"></div>

  <script>
    const names = [
      "Brendan Varga", "Doug Kennedy", "Gerrit Cramer", "Isaac Miller", "John Stebelton",
      "Joe Beattie", "Kayla Plancon", "Kyle Buchner", "Kyle Miller", "Melanie Sobas",
      "Paul Bater", "Renee Kehren", "Rob Mooney", "Scott Sieg", "Steve Rowland", "Will Houser"
    ];

    const statuses = {
      "I need work": "orange",
      "I need help": "red",
      "I'm good": "green",
      "I can do more": "blue"
    };

    const endpoint = "https://script.google.com/macros/s/AKfycbwlTdK8rrQ9EBAI9cvymf0a20XVqL0FNl6fwvB0xfwFR2qQtCEiEXrq6wfHdkEFIuhhUg/exec"; // Replace with your Apps Script Web App URL

    function getStatusBoard() {
      fetch(endpoint)
        .then(res => res.json())
        .then(data => {
          document.getElementById("statusBoard").innerHTML = '';
          data.slice(1).forEach(row => {
            const [name, status] = row;
            const rowDiv = document.createElement("div");
            rowDiv.className = `status-row ${statuses[status] || ''}`;
            const select = document.createElement("select");

            for (let key in statuses) {
              const opt = document.createElement("option");
              opt.value = key;
              opt.text = key;
              if (status === key) opt.selected = true;
              select.appendChild(opt);
            }

            select.onchange = () => {
              fetch(endpoint, {
                method: "POST",
                body: JSON.stringify({ name: name, status: select.value }),
                headers: { "Content-Type": "application/json" }
              }).then(() => getStatusBoard());
            };

            rowDiv.innerHTML = `<strong>${name}</strong>: `;
            rowDiv.appendChild(select);
            document.getElementById("statusBoard").appendChild(rowDiv);
          });
        });
    }

    // Auto-refresh every 10 seconds
    getStatusBoard();
    setInterval(getStatusBoard, 10000);
  </script>
</body>
</html>
